FSDP, как и [[ZERO]] -- это комбинация [[Data Parallelism|Data Parallel]] и [[Model Parallel]]. Отличие от [[ZERO]] в том, что мы режем слои горизонтально, а не вертикально.

При инициализации модели через FSDP происходит разбивка параметров на группы. Каждая видеокарта хранит свой шард параметров каждой группы. Во время форвард пасса мы делаем [[all_gather]] для очередной группы, чтобы собрать воедино ее шарды. После того, как форвард данной группы закончен, мы освобождаем на каждой видеокарте лишние параметры. Во время бэквард пасса мы снова делаем [[all_gather]], считаем градиент по своему батчу, получаем локальные градиенты на каждой карте. Затем делаем [[reduce_scatter]], тем самым на каждой карте у нас остаются синхронизированные градиенты для параметров, которые принадлежат этой карте. Таким образом, оптимайзер стейты получаются тоже шардированными.
# Forward/Backward Prefetching
Идея следующая: давайте, пока мы делаем вычисления в слое $i$, параллельно будем префетчить параметры для слоя $i +1$, тем самым накладывая вычисления и коммуникацию друг на друга. Это возможно и для бэкварда пасса, просто нужно делать префетчинг в обратную сторону.