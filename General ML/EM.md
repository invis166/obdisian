Хотим получить оценку на параметры распределения, максимизируя правдоподобие $p(X | \theta)$. Проблема: если распределение не из экспоненциального семейства, то вероятно ничего не получится. Идея: введем латентные переменные $Z$ так, чтобы совместное распределение $p(X, Z | \theta)$  лежало в экспоненциальном классе, таким образом сможем решить задачу. Латентные переменные представляют собой некоторе скрытое представление рассматриваемых объектов, некоторые скрытое состояние.
Итак, $p(X, Z | \theta)$ из экспоненциального класса. Тогда $\log p(X, Z | \theta)$ вогнутая функция по $\theta$ и ее можно легко оптимизировать.
$$
\begin{aligned}
	\log p(X | \theta) &= \int q(Z) \log p(X | \theta) dZ = \\
	& = \int q(Z) \log \frac{p(X, Z | \theta)}{p(Z |X,  \theta)} dZ = \\
	& = \int q(Z) \log \frac{p(X, Z | \theta) q(Z)}{p(Z |X,  \theta) q(Z)} dZ = \\
	& = \int q(Z) \log \frac{p(X, Z | \theta)}{q(Z)}dZ - \int q(Z) \frac{q(Z)}{p(Z | X, \theta)} dZ = \\
	& = \mathcal{L}(q, \theta) - KL(q(Z) || p(Z | X, \theta))
\end{aligned}
$$
Где $q(Z)$ --  некоторое распределение на латентные переменные. $\mathcal{L(q, \theta)}$ -- ELBO (evidence lower bound), $KL$ -- KL дивергенция.
$\mathcal{L}(q, \theta)$ -- вариационная нижняя оценка на $\log p(X | \theta)$ с вариационным параметром $q$:
1. При $q = p(Z |X, \theta)$ выполняется равенство $\log p(X | \theta) = \mathcal{L}(q, \theta)$
2. При всех $q, \theta$ ELBO не превосходит лог-правдоподобия, потому что $KL \ge 0$

Оптимизация:
1. $\mathcal{L(q, \theta_0)} \rightarrow min_q: q = p(Z | X, \theta)$  
2. $\mathcal{L(q_0, \theta)} \rightarrow min_\theta$ 

