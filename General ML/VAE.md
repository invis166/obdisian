Хотим восстановить параметры распределения $\theta$ распределения $p_\theta(X).$ Можем решать задачу максимизацией правдоподобия $p(X | \theta)$. Однако, если распределение не из экспоненциального класса, а какое-то сложное -- картиночное --, то вряд ли это у нас получится. Воспользуемся трюком с введением латентных переменных. Маргинализуем по ним:
$$p(x) = \int p(x, z) dz = \int p(x | z) p(z) dz$$
Тогда, имея на руках $p(x | z)$ и $p(z)$ мы могли бы семплировать из $p(x)$. То есть, нам нужно:
1. $p(z | x)$ -- для подсчета $p(x | z)$ (теорема Байеса)
2. $$


$$\mathcal{L}(q, \theta) = \int q(Z) \log \frac{p(X, Z | \theta)}{p(Z | \theta)}d Z$$
Который является нижней вариационной оценкой на $p(X)$.